<?phpclass ResultSet{    var $result;	var $offset;    function ResultSet($result)	{	    $this->result = $result;		$this->offset = 0;	}	function num_rows()    {         return mysql_num_rows($this->result);    }	function fetch_array()    {	     $this->offset++;         return mysql_fetch_array($this->result);    }    function fetch_row()    {	     $this->offset++;	     return mysql_fetch_row($this->result);    }	function fetch_assoc()	{	     $this->offset++;	     return mysql_fetch_assoc($this->result);	}	function fetch_object()	{	     $this->offset++;	     return mysql_fetch_object($this->result);	}	function EOF()	{	   if($this->offset < $this->num_rows())	   {	      return false;	   }	   else	   {	      return true;	   }	}}class DB{    var $db_server;    var $db_name;    var $db_user;    var $db_pass;    var $dbh;	var $debug = false;    function DB()    {        $this->db_server = DBHOST;        $this->db_name = DBNAME;        $this->db_user = DBUSER;        $this->db_pass = DBPASS;        $this->connect();    }    function connect()    {         $this->dbh = @mysql_connect($this->db_server, $this->db_user, $this->db_pass);         if (!$this->dbh)         {                printf("Error: Connection to MySQL server failed.<BR>\n");                return;         }         if (!@mysql_select_db($this->db_name, $this->dbh))         {                printf("Error: Selection of MySQL database failed.");                return;         }    }    function query ($query)    {        //echo $query."<br>";		if(!$this->dbh) die();		$result = mysql_query($query, $this->dbh)       	or die("<br>".mysql_error());		if($this->debug)		{		   echo "<hr><i><font color='#4a80b5'>$query</font></i><hr>";		}	        return new ResultSet($result);        //return $result;    }	function GetRowById($tablename,$id){		$qry = "select * from `$tablename` where id = '$id'";		$result = mysql_query($qry, $this->dbh);		return new ResultSet($result); 	}	function GetRowByName($tablename,$name){		$qry = "select * from $tablename where name = '$name'";		$result = mysql_query($qry, $this->dbh);		return new ResultSet($result); 	}	function SearchQuery($tablename,$arraydata){		$sql = 'SELECT * FROM '.$tablename.' WHERE ';		while(list($key,$val) =each($arraydata)){			$sql.=$key.' =\''.$val.'\' AND ';		}		$sql = substr($sql,0,-5);		return $sql;	}	function UpdateQuery($tablename,$arraydata,$id){		 $sql = 'UPDATE '.$tablename.' SET ';		while(list($key,$val) =each($arraydata)){			$sql.=$key.' =\''.addslashes($val).'\',';		}		$sql = substr($sql,0,-1);		$sql .=' where id ='.$id;		return $sql;	}	function SpUpdateQuery($tablename,$arraydata,$id,$sp){		$sql = 'UPDATE '.$tablename.' SET ';		while(list($key,$val) =each($arraydata)){			$sql.=$key.' =\''.addslashes($val).'\',';		}		$sql = substr($sql,0,-1);		$sql .=' where '.$sp.' ='.$id;		return $sql;	}		function UpdateUser($tablename,$arraydata,$id){		 $sql = 'UPDATE '.$tablename.' SET ';		while(list($key,$val) =each($arraydata)){			$sql.=$key.' =\''.$val.'\',';		}		$sql = substr($sql,0,-1);		$sql .=' where employee_id ='.$id;		return $sql;	}	function UpdateUser2($tablename,$arraydata,$uid){		 $sql = 'UPDATE '.$tablename.' SET ';		while(list($key,$val) =each($arraydata)){			$sql.=$key.' =\''.$val.'\',';		}		$sql = substr($sql,0,-1);		$sql .=' where user_id ='.$uid;		return $sql;	}	function InsertQuery($tablename,$arraydata){		$sql = 'INSERT INTO `'.$tablename.'`(';		$values = "VALUES(";        while(list($key,$val) =each($arraydata)){			$sql.=$key.',';			$values .= "'".addslashes($val)."',";		}		$sql = substr($sql,0,-1).")".substr($values,0,-1).")";		return $sql;	}	function SelectAll($tablename,$page=null,$record=null){		if(!$this->dbh) die();		if($page==null&&$record==null)			$query = "select * from `$tablename`";		else{			$page  = $page * $record;			$query = "select * from `$tablename` LIMIT $page,$record";		}		$result = mysql_query($query, $this->dbh)     	or die("<br>".mysql_error());		if($this->debug){		   echo "<hr><i><font color='#4a80b5'>$query</font></i><hr>";		}        return new ResultSet($result);	}	function insert_id()	{	    return mysql_insert_id($this->dbh);	}	function SelectLimit($sql, $limit1, $limit2)	{	   if($limit1 < 0)	      $limit1 = 0;		$sql.=' LIMIT '.$limit1.','.$limit2;				$rs = $this->query($sql);        		return $rs;	}}?>